var _=3.14159265358979,q=1;function N(t=1e5){let e=[];for(let o=0;o<t;o++){let r=Math.random(),n=Math.random(),s=r*r+n*n<=q*q;e.push({x:r,y:n,inside:s})}return e}function F(t){let e=t.filter(n=>n.inside).length,o=4*e/t.length,r=Math.abs(o-_);return{estimate:o,error:r,total:t.length,inside:e}}function W(t=10,e=1e5){let o=[];for(let i=0;i<t;i++){let c=N(e),{estimate:p}=F(c);o.push(p)}let r=o.reduce((i,c)=>i+c,0)/t,n=o.reduce((i,c)=>i+(c-r)**2,0)/(t-1),s=Math.sqrt(n);return{mean:r,stddev:s,trials:t,estimates:o}}var V=(t=0)=>e=>`\x1B[${e+t}m`,H=(t=0)=>e=>`\x1B[${38+t};5;${e}m`,z=(t=0)=>(e,o,r)=>`\x1B[${38+t};2;${e};${o};${r}m`,l={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},Ue=Object.keys(l.modifier),Re=Object.keys(l.color),Ae=Object.keys(l.bgColor),Ye=[...Re,...Ae];function Oe(){let t=new Map;for(let[e,o]of Object.entries(l)){for(let[r,n]of Object.entries(o))l[r]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},o[r]=l[r],t.set(n[0],n[1]);Object.defineProperty(l,e,{value:o,enumerable:!1})}return Object.defineProperty(l,"codes",{value:t,enumerable:!1}),l.color.close="\x1B[39m",l.bgColor.close="\x1B[49m",l.color.ansi=V(),l.color.ansi256=H(),l.color.ansi16m=z(),l.bgColor.ansi=V(10),l.bgColor.ansi256=H(10),l.bgColor.ansi16m=z(10),Object.defineProperties(l,{rgbToAnsi256:{value(e,o,r){return e===o&&o===r?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(o/255*5)+Math.round(r/255*5)},enumerable:!1},hexToRgb:{value(e){let o=/[a-f\d]{6}|[a-f\d]{3}/i.exec(e.toString(16));if(!o)return[0,0,0];let[r]=o;r.length===3&&(r=[...r].map(s=>s+s).join(""));let n=Number.parseInt(r,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:e=>l.rgbToAnsi256(...l.hexToRgb(e)),enumerable:!1},ansi256ToAnsi:{value(e){if(e<8)return 30+e;if(e<16)return 90+(e-8);let o,r,n;if(e>=232)o=((e-232)*10+8)/255,r=o,n=o;else{e-=16;let c=e%36;o=Math.floor(e/36)/5,r=Math.floor(c/6)/5,n=c%6/5}let s=Math.max(o,r,n)*2;if(s===0)return 30;let i=30+(Math.round(n)<<2|Math.round(r)<<1|Math.round(o));return s===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(e,o,r)=>l.ansi256ToAnsi(l.rgbToAnsi256(e,o,r)),enumerable:!1},hexToAnsi:{value:e=>l.ansi256ToAnsi(l.hexToAnsi256(e)),enumerable:!1}}),l}var ye=Oe(),m=ye;import w from"node:process";import Ce from"node:os";import K from"node:tty";function f(t,e=globalThis.Deno?globalThis.Deno.args:w.argv){let o=t.startsWith("-")?"":t.length===1?"-":"--",r=e.indexOf(o+t),n=e.indexOf("--");return r!==-1&&(n===-1||r<n)}var{env:a}=w,I;f("no-color")||f("no-colors")||f("color=false")||f("color=never")?I=0:(f("color")||f("colors")||f("color=true")||f("color=always"))&&(I=1);function Ie(){if("FORCE_COLOR"in a)return a.FORCE_COLOR==="true"?1:a.FORCE_COLOR==="false"?0:a.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(a.FORCE_COLOR,10),3)}function Se(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function $e(t,{streamIsTTY:e,sniffFlags:o=!0}={}){let r=Ie();r!==void 0&&(I=r);let n=o?I:r;if(n===0)return 0;if(o){if(f("color=16m")||f("color=full")||f("color=truecolor"))return 3;if(f("color=256"))return 2}if("TF_BUILD"in a&&"AGENT_NAME"in a)return 1;if(t&&!e&&n===void 0)return 0;let s=n||0;if(a.TERM==="dumb")return s;if(w.platform==="win32"){let i=Ce.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in a)return["GITHUB_ACTIONS","GITEA_ACTIONS","CIRCLECI"].some(i=>i in a)?3:["TRAVIS","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(i=>i in a)||a.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in a)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(a.TEAMCITY_VERSION)?1:0;if(a.COLORTERM==="truecolor"||a.TERM==="xterm-kitty"||a.TERM==="xterm-ghostty"||a.TERM==="wezterm")return 3;if("TERM_PROGRAM"in a){let i=Number.parseInt((a.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(a.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(a.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(a.TERM)||"COLORTERM"in a?1:s}function X(t,e={}){let o=$e(t,{streamIsTTY:t&&t.isTTY,...e});return Se(o)}var Me={stdout:X({isTTY:K.isatty(1)}),stderr:X({isTTY:K.isatty(2)})},Z=Me;function Q(t,e,o){let r=t.indexOf(e);if(r===-1)return t;let n=e.length,s=0,i="";do i+=t.slice(s,r)+e+o,s=r+n,r=t.indexOf(e,s);while(r!==-1);return i+=t.slice(s),i}function J(t,e,o,r){let n=0,s="";do{let i=t[r-1]==="\r";s+=t.slice(n,i?r-1:r)+e+(i?`\r
`:`
`)+o,n=r+1,r=t.indexOf(`
`,n)}while(r!==-1);return s+=t.slice(n),s}var{stdout:ee,stderr:te}=Z,v=Symbol("GENERATOR"),g=Symbol("STYLER"),E=Symbol("IS_EMPTY"),oe=["ansi","ansi","ansi256","ansi16m"],b=Object.create(null),_e=(t,e={})=>{if(e.level&&!(Number.isInteger(e.level)&&e.level>=0&&e.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let o=ee?ee.level:0;t.level=e.level===void 0?o:e.level};var Ne=t=>{let e=(...o)=>o.join(" ");return _e(e,t),Object.setPrototypeOf(e,R.prototype),e};function R(t){return Ne(t)}Object.setPrototypeOf(R.prototype,Function.prototype);for(let[t,e]of Object.entries(m))b[t]={get(){let o=S(this,L(e.open,e.close,this[g]),this[E]);return Object.defineProperty(this,t,{value:o}),o}};b.visible={get(){let t=S(this,this[g],!0);return Object.defineProperty(this,"visible",{value:t}),t}};var B=(t,e,o,...r)=>t==="rgb"?e==="ansi16m"?m[o].ansi16m(...r):e==="ansi256"?m[o].ansi256(m.rgbToAnsi256(...r)):m[o].ansi(m.rgbToAnsi(...r)):t==="hex"?B("rgb",e,o,...m.hexToRgb(...r)):m[o][t](...r),Fe=["rgb","hex","ansi256"];for(let t of Fe){b[t]={get(){let{level:o}=this;return function(...r){let n=L(B(t,oe[o],"color",...r),m.color.close,this[g]);return S(this,n,this[E])}}};let e="bg"+t[0].toUpperCase()+t.slice(1);b[e]={get(){let{level:o}=this;return function(...r){let n=L(B(t,oe[o],"bgColor",...r),m.bgColor.close,this[g]);return S(this,n,this[E])}}}}var we=Object.defineProperties(()=>{},{...b,level:{enumerable:!0,get(){return this[v].level},set(t){this[v].level=t}}}),L=(t,e,o)=>{let r,n;return o===void 0?(r=t,n=e):(r=o.openAll+t,n=e+o.closeAll),{open:t,close:e,openAll:r,closeAll:n,parent:o}},S=(t,e,o)=>{let r=(...n)=>ve(r,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(r,we),r[v]=t,r[g]=e,r[E]=o,r},ve=(t,e)=>{if(t.level<=0||!e)return t[E]?"":e;let o=t[g];if(o===void 0)return e;let{openAll:r,closeAll:n}=o;if(e.includes("\x1B"))for(;o!==void 0;)e=Q(e,o.close,o.open),o=o.parent;let s=e.indexOf(`
`);return s!==-1&&(e=J(e,n,r,s)),r+e+n};Object.defineProperties(R.prototype,b);var Be=R(),Je=R({level:te?te.level:0});var h=Be;var u=20,Le=40,d=10;function re(t){let e=Array.from({length:u},()=>Array(u).fill(" ")),o=0,r=0;for(let n of t){let s=Math.floor(n.x*u),i=Math.floor((1-n.y)*u);n.inside?(o++,i>=0&&i<u&&s>=0&&s<u&&(e[i][s]=h.green("\u25CF"))):(r++,i>=0&&i<u&&s>=0&&s<u&&(e[i][s]=h.red("\u25CB")))}for(let n=0;n<u;n++)for(let s=0;s<u;s++){let i=s/u,c=1-n/u,p=Math.sqrt(i*i+c*c);Math.abs(p-1)<.06&&e[n][s]===" "&&(e[n][s]=h.blue("\xB7"))}console.log(h.bold(`
  Quarter-Circle Dartboard`)),console.log("  "+"\u2500".repeat(u*2+2));for(let n of e)console.log("  \u2502"+n.map(s=>s+" ").join("")+"\u2502");console.log("  "+"\u2500".repeat(u*2+2)),console.log(`  ${h.green("\u25CF")} inside: ${o}  ${h.red("\u25CB")} outside: ${r}  \u03C0 \u2248 ${(4*o/t.length).toFixed(4)}`)}function ne(t){let e=Math.min(...t),r=Math.max(...t)-e||.001,n=Array(d).fill(0);for(let i of t){let c=Math.min(Math.floor((i-e)/r*d),d-1);n[c]++}let s=Math.max(...n);console.log(h.bold(`
  Distribution of Pi Estimates`)),console.log();for(let i=0;i<d;i++){let c=(e+r*i/d).toFixed(3),p=Math.round(n[i]/s*Le),T="\u2588".repeat(p),y=e+r*i/d<=3.14159&&3.14159<=e+r*(i+1)/d?h.yellow(`${c} \u03C0\u2192`):`${c}   `;console.log(`  ${y} ${h.cyan(T)} ${n[i]}`)}}var se=/[\s,;:!?.]+/,De=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function Pe(t,...e){return t.reduce((o,r,n)=>{let s=n<e.length?`[${e[n]}]`:"";return o+r+s},"")}function ie(t){return t.split(se).filter(e=>e.length>0).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" ")}function le(t){let e=t.toLowerCase().split(se).filter(Boolean),o=new Map;for(let r of e)o.set(r,(o.get(r)||0)+1);return o}function D(t){return De.test(t)}function ae(t,e,o){return Pe`Result: ${t} = ${e} ${o}`}async function P(t,e=10){return await new Promise(o=>setTimeout(o,e)),{url:t,status:200,data:`Response from ${t}`}}async function ce(t){return(await Promise.all(t.map(o=>P(o)))).map(o=>o.data)}function*ue(t=10){let e=0,o=1;for(let r=0;r<t;r++)yield e,[e,o]=[o,e+o]}var x=class t{#e;#t;constructor(e,o="black"){this.#e=e,this.#t=o}get name(){return this.#e}get color(){return this.#t}set color(e){this.#t=e}area(){throw new Error(`${this.#e}.area() not implemented`)}describe(){return`${this.#t} ${this.#e} with area ${this.area().toFixed(4)}`}static isShape(e){return e instanceof t}},$=class extends x{#e;constructor(e,o){super("circle",o),this.#e=e}get radius(){return this.#e}area(){return Math.PI*this.#e**2}circumference(){return 2*Math.PI*this.#e}},A=class extends x{#e;#t;constructor(e,o,r){super("rectangle",r),this.#e=e,this.#t=o}get width(){return this.#e}get height(){return this.#t}area(){return this.#e*this.#t}perimeter(){return 2*(this.#e+this.#t)}isSquare(){return this.#e===this.#t}};function fe(t){let e=t.reduce((r,n)=>r+n.area(),0),o={};for(let r of t){let n=r.name;o[n]=(o[n]||0)+1}return{totalArea:e,count:t.length,byType:o}}function me(t){return[...t].sort((e,o)=>o.score-e.score).map(({name:e,score:o},r)=>({rank:r+1,name:e,score:o}))}function he(t,e){return t.reduce((o,r)=>{let n=e(r);return{...o,[n]:[...o[n]??[],r]}},{})}function G(t,e="unknown"){return t?.data?.nested?.value??e}function pe(...t){return t.reduce((e,o)=>({...e,...o}),{})}function de(t){if(t.length===0)return{min:0,max:0,mean:0,sum:0,count:0};let{min:e,max:o,sum:r}=t.reduce((n,s)=>({min:Math.min(n.min,s),max:Math.max(n.max,s),sum:n.sum+s}),{min:1/0,max:-1/0,sum:0});return{min:e,max:o,mean:r/t.length,sum:r,count:t.length}}var j="Hello from demini test fixture",ge="1.0.0";var be=1.6180339887;var xe=Object.freeze({DEBUG:0,INFO:1,WARN:2,ERROR:3}),Te=Object.freeze({verbose:!1,precision:14,maxRetries:3,greeting:j});async function Ge(){console.log(`${j} v${ge}
`),console.log("=== Monte Carlo Pi Estimation ===");let t=N(500),e=F(t);console.log(`  Single trial (${e.total} darts): \u03C0 \u2248 ${e.estimate.toFixed(6)} (error: ${e.error.toFixed(6)})`),re(t);let o=W(20,1e4);console.log(`
  Multi-trial (${o.trials} x 10k): mean \u03C0 \u2248 ${o.mean.toFixed(6)} (\u03C3 = ${o.stddev.toFixed(6)})`),ne(o.estimates),console.log(`
=== String Utilities ===`);let r=ie("the quick brown fox jumps over the lazy dog");console.log(`  Title case: "${r}"`);let n=le("to be or not to be that is the question");console.log(`  Word frequencies: ${JSON.stringify(Object.fromEntries(n))}`),console.log(`  Email valid: ${D("user@example.com")}`),console.log(`  Email invalid: ${D("not-an-email")}`),console.log(`  ${ae("pi",e.estimate.toFixed(4),"radians")}`),console.log(`
=== Async Patterns ===`);let s=await P("https://api.example.com/data");console.log(`  Fetch: ${s.data} (status ${s.status})`);let i=await ce(["https://a.test","https://b.test"]);console.log(`  Parallel fetch: ${i.length} responses`);let c=[...ue(10)];console.log(`  Fibonacci(10): [${c.join(", ")}]`),console.log(`
=== Class Hierarchy ===`);let p=new $(5,"blue"),T=new A(4,6,"red"),O=new A(3,3,"green");console.log(`  ${p.describe()}`),console.log(`  ${T.describe()} (square: ${T.isSquare()})`),console.log(`  ${O.describe()} (square: ${O.isSquare()})`),console.log(`  Shape.isShape(circle): ${x.isShape(p)}`);let y=fe([p,T,O]);console.log(`  Report: ${y.count} shapes, total area ${y.totalArea.toFixed(4)}`),console.log(`
=== Data Transforms ===`);let k=[{name:"Alice",score:95},{name:"Bob",score:87},{name:"Charlie",score:92},{name:"Diana",score:98}],Ee=me(k);console.log(`  Leaderboard: ${Ee.map(C=>`#${C.rank} ${C.name}`).join(", ")}`);let U=he(k,C=>C.score>=90?"A":"B");console.log(`  Groups: A=${U.A?.length??0}, B=${U.B?.length??0}`),console.log(`  Safe extract: "${G({data:{nested:{value:"found it"}}})}", missing: "${G({})}"`);let M=de([1,2,3,4,5]);console.log(`  Stats: mean=${M.mean}, min=${M.min}, max=${M.max}`);let Y=pe(Te,{verbose:!0});console.log(`  Merged config verbose: ${Y.verbose}, precision: ${Y.precision}`),console.log(`
=== Constants ===`),console.log(`  LogLevel.WARN = ${xe.WARN}`),console.log(`  Golden ratio: ${be}`),console.log(`  Pi reference: ${_}`),console.log(`
Done.`)}Ge().catch(console.error);
